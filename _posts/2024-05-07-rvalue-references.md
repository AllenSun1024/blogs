---
layout: post
title:  "Rvalue References"
author: Allen Sun
tags: C++ Rvalue Move-Semantics
---

# 1 左值与右值

- 左值

    - 可以在赋值符=左边出现。

    - 有地址，即占据内存。

- 右值

    - 可以在赋值符=右边出现。

    - 不可取地址，通常包括：立即数(如：5, '5')、临时变量(如：函数返回值)。

# 2 左值引用与右值引用

引用即变量的别名，底层用指针实现。

- 左值引用

    - 仅能指向左值。

        ```cpp
        int a = 1;
        int& ref1 = a;  // ok
        int& ref2 = 5;  // error: 左值引用不能指向右值

        /* const左值引用不会改变右值，所以其可以指向右值 */
        const int& ref3 = 5;  // ok
        ```

- 右值引用

    - 仅能指向右值。

        ```cpp
        int&& ref1 = 5;  // ok

        int a = 1;
        int&& ref2 = a;  // error: 右值引用不能指向左值
        ```

- Q&A

    1. 左/右值引用自身是左值还是右值？

        A：左/右值引用有自己的内存，可以出现在赋值符=左边，故为左值。

    2. 右值引用是否可以指向左值？

        A：可以通过std::move()。

        ```cpp
        int a = 1;
        int&& ref1 = a;  // error
        int&& ref2 = std::move(a);  // ok
        ```

        另外，右值引用可以指向右值的底层行为逻辑是：首先，将右值提升为左值；然后，定义一个右值引用；最后，通过std::move()使得右值引用指向对应左值。

    3. 为什么需要右值引用指向左值？

        A：读懂全文后，你就知道啦。

# 3 